{% macro input(field, label, help=False) -%}
<div class="control-group {% if field.errors %}error{% elif field.value() %}success{% endif %}">
  <label class="control-label" for="id_{{field.name}}">{{label}}</label>
  <div class="controls">
    {{field|safe}}
    {% if field.errors %}
    <span class="help-inline">{{field.errors|safe}}</span>
    {% elif help %}
    <span class="help-inline">{{help}}</span>
    {% endif %}
  </div>
</div>
{%- endmacro %}

{% macro session_time_distance(form) -%}
<div class="control-group time-distance" style="height: 25px">
  <div class="controls">
    <div class="input-prepend time">
      <span class="add-on">Temps</span>
      {{ form.time|safe }}
    </div>
    <div class="input-prepend distance">
      <span class="add-on" rel="tooltip" title="Distance en course à pied uniquement.">Distance cap</span>
      {{ form.distance|safe }}
    </div>
  </div>
</div>
{% if form.distance.errors %}
<div class="alert alert-danger">{{form.distance.errors|safe}}</div>
{% endif %}
{% if form.time.errors %}
<div class="alert alert-danger">{{form.time.errors|safe}}</div>
{% endif %}
{%- endmacro %}

{% macro session_types_name(form, types) -%}

{% with form.instance.type as type %}
{% with form.name as field %}
<div class="types-name control-group {% if field.errors %}error{% elif field.value() %}success{% endif %}">
  {% if field.errors %}
  <span class="help-inline">{{field.errors|safe}}</span>
  {% endif %}
  <label class="control-label" for="id_{{field.name}}">Séance</label>
  <div class="controls">
    <div class="input-prepend">
      <div class="btn-group">
        <button class="btn dropdown-toggle {% if type == 'race' %}btn-success{% elif type == 'rest'%}btn-info{% endif %}" data-toggle="dropdown">
          <span class="name">
          {% if type == 'training' %}
          Entraînement
          {% elif type == 'race' %}
          Course
          {% else %}
          Repos
          {% endif %}
          </span>
          <span class="caret"></span>
        </button>
        <ul class="dropdown-menu types">
          {% for k, name in types %}
          <li {% if k == type %}class="active"{% endif %}>
            <a href="#" value="{{k}}">{{name}}</a>
          </li>
          {% endfor %}
        </ul>
      </div>
      {{ form.type|safe }}
      {{ form.name|safe }}
    </div>
  </div>
</div>
{% endwith %}
{% endwith %}
{%- endmacro %}

{% macro race_category(form) -%}
<div class="control-group race-category {% if form.instance.type == 'race' %}active{% endif %}" style="height: 25px">
  <div class="controls">
    <div class="input-prepend time">
      <span class="add-on">Type de course</span>
      {{ form.race_category|safe }}
    </div>
  </div>
</div>
{% if form.race_category.errors %}
<div class="alert alert-danger">{{form.distance.errors|safe}}</div>
{% endif %}
{%- endmacro %}

{% macro tr(fields, item='td') -%}
<tr>
  {% for f in fields %}
  <{{item}}>{{f|default('-')}}</{{item}}>
  {% endfor %}
</tr>
{%- endmacro %}

{% macro sort_title(title, sort_name, urlname, urlargs, sort_active) %}
  {{ title }}
  {{ sort(sort_name, 'up', urlname, urlargs, sort_active) }}
  {{ sort(sort_name + '-r', 'down', urlname, urlargs, sort_active) }}
{%- endmacro %}

{% macro sort(sort_name, direction, urlname, urlargs, sort_active) %}

  {% set active = sort_name == sort_active %}
  <span class="badge {% if active %}badge-inverse{% else %}badge-info{% endif %}">
    {% if active %}
    <i class="icon-chevron-{{direction}} icon-white"></i>
    {% else %}
    <a href="{{ urlname|url(*urlargs + (sort_name, )) }}"><i class="icon-chevron-{{direction}} icon-white"></i></a>
    {% endif %}
  </span>

{%- endmacro %}
