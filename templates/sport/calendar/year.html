{% extends 'base.html' %}

{% set page_title = 'Année %s' % year %}
{% set page_size = 'fullscreen' %}

{% block style %}
<style>
	.head a {
		width: 100%;
		display: block;
		text-overflow: ellipsis;
		overflow: hidden;
	}
</style>
{% endblock %}

{% block content %}
<div class="container" id="calendar">

	<div class="row">
    {% if member %}
    <div class="col-sm-1 col-xs-2">
      <img class="img-responsive img-rounded" alt="Avatar" src="{{ member.avatar.url }}" />
    </div>
    <div class="col-sm-5 col-xs-10">
      <h3>{{ member.first_name }} {{ member.last_name }}</h3>
      <h4>Année {{ year }}</h4>
    </div>
    {% else %}
		<div class="col-sm-6">
      <h3>Année {{ year }}</h3>
		</div>
    {% endif %}

		<div class="col-sm-6 text-right buttons">
			{% if member %}
			<a class="btn btn-success btn-light" href="{% url athlete-stats-year member.username, year %}"><i class="icon-plus"></i> Statistiques</a>
      <a href="{% url user-public-profile member.username %}" class="btn btn-primary btn-light">
        <i class="icon-user"></i> Voir son profil
      </a>
      {% else %}
			<a class="btn btn-success btn-light" href="{% url stats-year year %}"><i class="icon-plus"></i> Statistiques</a>
			{% endif %}
		</div>
	</div>

  <table class="table  table-condensed calendar hidden-xs">
    <tr>
      <td>
        <div class="year hidden-xs">
          {% for month, days in date_list.items() %}
          <div class="month">
            <div class="head">
              <a href="{{ pagemonth|url(*pageargs + [year, month.month]) }}" >{{ month|date('E')|title() }}</a>
            </div>

            {% for day_date, day in days.items() %}
            <div class="day link" href="{{ pageday|url(*pageargs + [day_date.year, day_date.month, day_date.day]) }}">
              <span class="date">{{ day_date.day }}</span>
              {% if day %}
                <p class="name">
                {% for s in day.sessions.all() %}
                  <span class="session {{ s.type }}">
                    <i class="icon-sport-{{s.sport.slug}}"></i>
                    {% if day.sessions.count() == 1 %}
                      {{ s.name|default('...')|truncatechars(20) }}
                    {% endif %}
                  </span>
                {% endfor %}
                </p>
              {% endif %}
            </div>
            {% endfor %}

          </div>
          {% endfor %}
        </div>
      </td>
    </tr>
  </table>

	<div class="visible-xs">
    {% for month, days in date_list.items() %}
    {% if month.month in months_active %}
      <h3>
        {{ month|date('E Y')|title() }}
        <a href="{% url report-month month.year, month.month %}" class="btn btn-sm btn-info pull-right">Voir ce mois</a>
      </h3>
			<div class="row-striped">
	      {% for day_date,day in days.items() %}
        {% include 'sport/calendar/_day.xs.html' %}
	      {% endfor %}
			</div>
    {% endif %}
    {% endfor %}
    </div>

	<ul class="pager">
		{% if previous_year %}
		<li class="previous">
			<a href="{{ pageyear|url(*pageargs + [previous_year, ]) }}">&laquo; Année {{ previous_year }}</a>
		</li>
		{% endif %}
		{% if next_year %}
		<li class="next">
			<a href="{{ pageyear|url(*pageargs + [next_year, ]) }}">Année {{ next_year }} &raquo;</a>
		</li>
		{% endif %}
	</ul>
</div>
{% endblock %}
