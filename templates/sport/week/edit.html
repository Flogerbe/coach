{% extends 'base.html' %}

{% block content %}
<div class="container week">
  <div class="row">
    <div class="col-sm-9 col-xs-12">
      {% if member %}
      <h3>{{ member.first_name }} {{ member.last_name }} : Semaine du {{ report }}</h3>
      {% else %}
      <h3>Votre semaine du {{ report }}</h3>
      {% endif %}
    </div>
    <div class="actions col-sm-3 col-xs-12 text-right hidden-xs">
    {% if not member  %}
      {% if report.published or report.task %}
      <a href="{% url report-week-publish report.year, report.week %}" class="modal-action btn btn-success">Semaine publiée</a>
      {% else %}
      <a href="{% url report-week-publish report.year, report.week %}" class="{% if not report.is_publiable() %}disabled{% endif %} modal-action btn btn-info">Publier la semaine <i class="icon-right-open"></i></a>
      {% endif %}
    {% endif %}
    </div>
  </div>

  {% if trainer %}
  <p class="alert alert-success">
    Ce rapport a bien été envoyé à {{trainer.first_name|default(trainer.username)}}
  </p>
  {% endif %}

  {% for day_date, day in report.get_days_per_date().items() %}
  <div class="row day actions-hover link" href="{{ pageday|url(*pageargs + [day_date.year, day_date.month, day_date.day]) }}">
    <h4>
      <a href="{{ pageday|url(*pageargs + [day_date.year, day_date.month, day_date.day]) }}">
        {{day_date|date('l d E')|title()}}
      </a>
    </h4>
      {% include 'sport/session/list.html' %}
  </div>
  {% endfor %}

  <hr />

  <div>
    <h4>Bilan de la semaine</h4>
    <div class="pull-right">
    {% if not member  %}
      {% if report.published or report.task %}
      <a href="{% url report-week-publish report.year, report.week %}" class="modal-action btn btn-success">Semaine publiée</a>
      {% else %}
      <a href="{% url report-week-publish report.year, report.week %}" class="{% if not report.is_publiable() %}disabled{% endif %} modal-action btn btn-info">Publier la semaine <i class="icon-right-open"></i></a>
      {% endif %}
    {% endif %}
    </div>

    {% if report.comment %}
    <blockquote>
      {{ report.comment }}
    </blockquote>
    {% else %}
    <i class="text-muted">Pas de commentaire général</i>
    {% endif %}

    <h4>Statistiques</h4>
    {% with report.get_sports_stats() as stats %}
      {% include 'sport/week/_stats.html' %}
    {% endwith %}
  </div>

  {% include '_weeks.html' %}
</div>
{% endblock %}
